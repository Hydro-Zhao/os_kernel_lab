kern/mm/default_pmm.c

kern/mm/pmm.c

# 实验记录

不知道为什么kern/init/init.c中grade_backtrace()测试返回后会回到kern_init函数开始处继续运行（还是说kern_init又被调用了？看gdb），导致后面mm相关测试无法进行，也就不可能通过测试（我还傻乎乎地静态分析了那么久，实际上gdb调试一下很快就定位到问题了（既然ucore的测试是通过对比qemu的输出，那就实际看一下输出是什么啊））。

## 实验手册

讲解物理内存探测的部分终于解决了我很多疑惑

建立段页式管理中需要考虑的关键问题 中的问题任然没有解决
> 从新设置全局段描述符表的作用是什么？
> 对于哪些物理内存空间需要建立页映射关系？
> 具体的页映射关系是什么？
> 页目录表的起始地址设置在哪里？
> 页表的起始地址设置在哪里，需要多大空间？
> 如何设置页目录表项的内容？

> 如何在建立页表的过程中维护全局段描述符表（GDT）和页表的关系，确保 ucore 能够在各个时间段上都能正常寻址？

链接地址/虚地址/物理地址/加载地址以及 edata/end/text 的含义 值得一看

实验执行流程概述 可以对物理内存管理部分流程有明确概念

## exercise1

实验框架已经写完几乎所有的代码，我只需要按照首次适应算法的逻辑修改相关部分就行了，主要就是要在正确的位置插入缩小或扩大的空闲链表项（使得链表是按地址由低到高排列）。

## exercise2

按照代码中的注释填写代码

注意在地址转换过程中使用的是物理地址还是线性地址。页目录项和页表项中使用的是物理地址，在由页目录项得到页表地址时，要将页目录项的地址转换成线性地址。

## exercise3

要回答练习中的问题，要反复阅读 系统执行中地址映射的三个阶段 这一部分。

非常愚蠢的bug
```
right: if (!create || (page = alloc_page()) == NULL)
wrong: if (!create || (page = alloc_page() == NULL))
```